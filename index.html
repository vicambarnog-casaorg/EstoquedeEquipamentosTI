<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistema de Patrimônio - Dashboard</title>

    <style>
        * { margin:0; padding:0; box-sizing:border-box; font-family:Arial, sans-serif; }

        body { display:flex; background:#f5f6fa; height:100vh; }

        /* SIDEBAR */
        .sidebar {
            width:240px; background:#1e1f26; color:#fff; padding:20px;
            display:flex; flex-direction:column;
        }
        .sidebar h2 { margin-bottom:20px; }
        .sidebar button {
            background:none; border:none; color:#fff; padding:12px;
            text-align:left; cursor:pointer; border-radius:6px;
        }
        .sidebar button:hover { background:#2b2c33; }

        /* HEADER */
        .header {
            height:60px; background:#fff; display:flex;
            justify-content:space-between; align-items:center;
            padding:0 20px; border-bottom:1px solid #ddd;
        }

        /* CONTENT */
        .content {
            flex:1; display:flex; flex-direction:column;
        }

        /* TABLE */
        table {
            width:100%; border-collapse:collapse; margin-top:20px;
        }
        th,td {
            padding:12px; border-bottom:1px solid #ddd;
            text-align:left;
        }
        th { background:#eee; }

        /* FORMS */
        .card {
            background:#fff; padding:20px; border-radius:8px;
            box-shadow:0 0 10px rgba(0,0,0,0.1); margin-top:20px;
        }

        .hidden { display:none; }

        /* MODAL CAMERA */
        #cameraModal, #manutencaoModal {
            position:fixed; top:0; left:0; width:100%; height:100%;
            background:rgba(0,0,0,0.7); display:none;
            justify-content:center; align-items:center;
        }
        .modal-content {
            background:#fff; padding:20px; border-radius:8px;
            width:400px; text-align:center;
        }
        video, canvas { width:100%; border-radius:8px; margin-bottom:10px; }

        /* LOGIN */
        #loginArea {
            margin:auto; width:300px; background:#fff; padding:20px;
            border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>

    <div id="loginArea" class="">
        <h2>Login</h2><br>
        <input id="emailLogin" type="email" placeholder="E-mail" style="width:100%;padding:10px;"><br><br>
        <input id="senhaLogin" type="password" placeholder="Senha" style="width:100%;padding:10px;"><br><br>
        <button onclick="login()" style="width:100%;padding:10px;">Entrar</button>
    </div>

    <div id="dashboard" class="hidden" style="width:100%;">

        <div class="sidebar">
            <h2>Sistema</h2>
            <button onclick="mostrarLista()">Lista de Produtos</button>
            <button onclick="mostrarCadastro()">Cadastrar Produto</button>
            <button onclick="logout()">Sair</button>
        </div>

        <div class="content">
            <div class="header">
                <h2 id="tituloTopo">Painel</h2>
            </div>

            <!-- LISTA -->
            <div id="listaArea" class="card">
                <h3>Produtos cadastrados</h3>
                <table id="tabelaProdutos">
                    <thead>
                        <tr>
                            <th>N Patrimônio</th>
                            <th>Equipamento</th>
                            <th>Setor</th>
                            <th>Foto</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- CADASTRO -->
            <div id="cadastroArea" class="card hidden">
                <h3>Novo Produto</h3><br>
                <input id="patrimonio" placeholder="Nº Patrimônio" style="width:100%;padding:10px;"><br><br>
                <input id="equipamento" placeholder="Equipamento" style="width:100%;padding:10px;"><br><br>
                <input id="setor" placeholder="Setor" style="width:100%;padding:10px;"><br><br>

                <button onclick="openCameraModal()">Tirar Foto</button>
                <div id="previewFotos"></div>

                <br>
                <button onclick="salvarProduto()">Salvar</button>
            </div>

            <!-- DETALHES -->
            <div id="detalhesArea" class="card hidden">
                <h3 id="detalhesTitulo"></h3>
                <p><b>Patrimônio:</b> <span id="detalhesPat"></span></p>
                <p><b>Setor:</b> <span id="detalhesSetor"></span></p>

                <h4>Fotos</h4>
                <div id="listaFotos"></div>
                <br>
                <button onclick="openCameraModal(true)">Adicionar Foto</button><br><br>

                <h4>Histórico de Manutenção</h4>
                <div id="listaManutencao"></div>
                <br>
                <button onclick="abrirModalManutencao()">Adicionar Manutenção</button>
            </div>

        </div>
    </div>

    <!-- MODAL CAMERA -->
    <div id="cameraModal">
        <div class="modal-content">
            <video id="cameraVideo" autoplay></video>
            <button onclick="capturarFoto()">Capturar</button><br><br>
            <button onclick="fecharCameraModal()">Fechar</button>
        </div>
    </div>

    <!-- MODAL MANUTENÇÃO -->
    <div id="manutencaoModal">
        <div class="modal-content">
            <h3>Adicionar Manutenção</h3>
            <textarea id="manutencaoTexto" style="width:100%;height:100px;"></textarea><br><br>
            <button onclick="salvarManutencao()">Salvar</button><br><br>
            <button onclick="fecharManutencaoModal()">Fechar</button>
        </div>
    </div>

    <!-- ############### IMPORTANTE ################ -->
    <!-- Firebase SDK deve vir ANTES dos seus scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <!-- ########################################## -->

    <!-- Seus scripts -->
    <script src="firebase.js"></script>
    <script src="camera.js"></script>
    <script src="storage-imagekit.js"></script>
    <script src="manutencao.js"></script>
    <script src="app.js"></script>

</body>
</html>
